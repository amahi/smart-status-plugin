mkdir -p elevated
cd elevated
cat > elevated-script << 'EOF'

lsblk -o name,type | grep disk | awk '{print $1;}' >> disk_names

while read line
  do
    mkdir /home/.smartctl-data
    smartctl -H '/dev/'$line > '/home/.smartctl-data/smartctl-'$line
done < disk_names

EOF
chmod +x elevated-script
sudo ./elevated-script
cd ..
rm -rf elevated
